<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Activa tu Bono</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom right, #1a1a1a, #000);
      color: #fff;
      text-align: center;
      padding: 0 20px;
    }

    .container {
      max-width: 480px;
      margin: 0 auto;
      padding-top: 60px;
    }

    .headline {
      font-size: 1.8rem;
      margin-bottom: 10px;
      font-weight: bold;
      color: #FFD700;
    }

    .subtext {
      font-size: 1.1rem;
      margin-bottom: 30px;
      color: #ddd;
    }

    .bonus-timer {
      font-size: 1rem;
      font-weight: bold;
      color: #FF6347;
      margin-bottom: 20px;
      animation: pulse 2s infinite;
    }

    .register-button {
      display: block;
      width: 100%;
      padding: 20px;
      font-size: 1.3rem;
      font-weight: bold;
      background: linear-gradient(45deg, #FFD700, #FF4500);
      border: none;
      border-radius: 12px;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
      color: #000;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .register-button:hover {
      transform: scale(1.05);
    }

    .testimonial {
      margin-top: 25px;
      font-size: 0.95rem;
      color: #ccc;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.6; }
      100% { opacity: 1; }
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .bounce {
      animation: bounce 1s infinite;
    }

    @media (max-width: 768px) {
      .register-button {
        position: fixed;
        bottom: 20px;
        left: 20px;
        right: 20px;
        z-index: 1000;
      }

      .container {
        padding-bottom: 100px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="headline">üéÅ Activa tu Usuario y Recib√≠ tu Bono</h1>
    <p class="subtext">Cre√° tu cuenta en segundos y reclam√° el bono exclusivo por WhatsApp</p>

    <div class="bonus-timer">
      ‚è≥ Bono disponible por tiempo limitado: <span id="countdown">01:59</span>
    </div>

    <button class="register-button" onclick="registrarYRedirigir()">üö® ACTIVAR BONO AHORA</button>

    <p class="testimonial">+350 personas ya activaron su bono hoy üéâ</p>
  </div>

  <!-- Facebook Pixel base code -->
  <script>
    !(function(f,b,e,v,n,t,s){
      if(f.fbq)return;n=f.fbq=function(){
        n.callMethod ?
        n.callMethod.apply(n,arguments) : n.queue.push(arguments)
      };
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src='https://connect.facebook.net/en_US/fbevents.js';
      s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)
    })(window, document, 'script');

    const PIXEL_ID = '{{TU_PIXEL_ID}}';
    fbq('init', PIXEL_ID);
    fbq('track', 'PageView');
  </script>

  <!-- Anti-bot + evento personalizado -->
  <script>
    const API_URL = '/api/conversion';
    const event_id = 'event_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6);

    function registrarYRedirigir() {
      fbq('trackCustom', 'Contacto', {
        eventID: event_id
      });

      // Datos Meta CAPI
      const fbp = getCookie('_fbp');
      const fbc = getCookie('_fbc') || `fb.1.${Date.now()}.${document.location.hostname}`;
      const data = {
        event_name: 'Contacto',
        event_time: Math.floor(Date.now() / 1000),
        action_source: 'website',
        event_source_url: window.location.href,
        event_id,
        fbp, fbc
      };

      // Protecci√≥n b√°sica: no enviar si userAgent es bot
      const isBot = /bot|crawl|slurp|spider/i.test(navigator.userAgent);
      if (!isBot) {
        fetch(API_URL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(data)
        }).then(() => {
          // Redirige a WhatsApp
          const mensaje = encodeURIComponent("Hola, quiero activar mi bono.");
          window.location.href = `https://wa.me/549XXXXXXXXXX?text=${mensaje}`;
        });
      }
    }

    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    }

    // Cuenta regresiva
    function startCountdown(minutes) {
      let time = minutes * 60;
      const el = document.getElementById('countdown');
      const interval = setInterval(() => {
        const min = String(Math.floor(time / 60)).padStart(2, '0');
        const sec = String(time % 60).padStart(2, '0');
        el.textContent = `${min}:${sec}`;
        time--;
        if (time < 0) clearInterval(interval);
      }, 1000);
    }

    startCountdown(2);

    // Animaci√≥n al bot√≥n
    setTimeout(() => {
      document.querySelector('.register-button').classList.add('bounce');
    }, 5000);
  </script>

  <noscript>
    <img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id={{TU_PIXEL_ID}}&ev=PageView&noscript=1"/>
  </noscript>
</body>
</html>
